# üèóÔ∏è ERP SaaS - Syst√®me de Gestion pour la Construction

> Syst√®me ERP complet pour la gestion de projets de construction, ressources humaines, √©quipements, achats/stocks et finances. Support multilingue (Fran√ßais, Russe, Roumain).

[![TypeScript](https://img.shields.io/badge/TypeScript-5.6-blue?logo=typescript)](https://www.typescriptlang.org/)
[![React](https://img.shields.io/badge/React-18.3-61DAFB?logo=react)](https://reactjs.org/)
[![PostgreSQL](https://img.shields.io/badge/PostgreSQL-Neon-336791?logo=postgresql)](https://neon.tech/)
[![Vite](https://img.shields.io/badge/Vite-5.4-646CFF?logo=vite)](https://vitejs.dev/)

---

## üìã Table des mati√®res

- [Vue d'ensemble](#-vue-densemble)
- [Fonctionnalit√©s](#-fonctionnalit√©s)
- [Architecture technique](#architecture-technique)
- [Installation & Configuration](#-installation--configuration)
- [Gestion des donn√©es](#-gestion-des-donn√©es)
- [Extension & Personnalisation](#-extension--personnalisation)
- [Roadmap & Am√©liorations](#-roadmap--am√©liorations)
- [Structure du projet](#Ô∏è-structure-du-projet)
- [API Reference](#-api-reference)

---

## üéØ Vue d'ensemble

Ce syst√®me ERP SaaS est con√ßu sp√©cifiquement pour les entreprises de construction et industrielles. Il centralise la gestion de tous les aspects op√©rationnels : chantiers, personnel, √©quipements, achats, finances et budgets.

### ‚ú® Points forts

- **Multilingue** : Interface compl√®te en Fran√ßais, Russe et Roumain (i18next)
- **Donn√©es r√©elles** : Import Excel avec 161 salari√©s, 193 √©quipements, 6 chantiers
- **Architecture moderne** : React 18 + TypeScript + Vite + PostgreSQL
- **Design professionnel** : Dark mode optimis√©, UI shadcn/ui, Tailwind CSS
- **Type-safe** : Validation Zod, Drizzle ORM, typage strict TypeScript

---

## üöÄ Fonctionnalit√©s

### üìä Tableau de bord (Dashboard)

- Vue d'ensemble des KPI : chantiers actifs, budgets, ressources
- Graphiques de progression budg√©taire (Recharts)
- Indicateurs de performance en temps r√©el

### üèóÔ∏è Gestion des chantiers

- Cr√©ation et suivi de projets de construction
- Budget d√©taill√© : Main d'≈ìuvre, Mat√©riaux, √âquipement (pr√©visionnel vs r√©el)
- Affectation de responsables de projet
- Suivi de progression (%)
- Code projet et b√©n√©ficiaire

### üë• Gestion des salari√©s (RH)

- Fiche compl√®te : Nom, fonction, comp√©tences, contacts
- Organisation : Division, Service, Centre de co√ªt
- Finances : Taux horaire, salaire mensuel, accords suppl√©mentaires
- Statuts : Disponible / Affect√© / Cong√©
- **Recherche en temps r√©el** : Filtrer par nom, pr√©nom, fonction, num√©ro interne
- **Filtres multiples** : Division, Service, Centre de co√ªt
- **Modification en masse** : Dialog d'√©dition avec validation Zod

### üöú Gestion des √©quipements

- Inventaire complet : ID, Mod√®le, Immatriculation, Ann√©e
- M√©tadonn√©es techniques : Type de carburant, GPS, compteur
- Co√ªts : Taux horaire, consommation carburant, co√ªt de maintenance
- **Affectation conducteur** : Relation avec table salari√©s (operatorId FK)
- Import Excel avec mapping automatique de colonnes

### üì¶ Achat/Stocks

- **Gestion des stocks** : Articles, quantit√©s, unit√©s, usines
- **Workflow de r√©ception** :
  - Cr√©ation d'achats (niveau Admin/Chantier)
  - Validation de r√©ception avec op√©rateur et date
  - Photo de facture (upload Base64, s√©curis√©)
  - Statuts : En attente ‚Üí R√©ceptionn√©
- **Usines** : Gestion des sites de production/stockage

### üí∞ Finances & Tr√©sorerie

- Suivi des d√©penses par chantier
- Cat√©gorisation des co√ªts
- Rapports budg√©taires avec comparaison pr√©visionnel/r√©el

### üè≠ Tableau de bord Usines

- **Consommations √©nerg√©tiques** :
  - Suivi consommation √©lectrique (kWh/MWh)
  - Suivi consommation gaz (kWh/m¬≥)
  - Historique par date et par usine
- **Production** :
  - Tonnes re√ßues par type de marchandise
  - Tonnes vendues avec tracking client
  - Analyse par type de produit (B√©ton, Acier, Gravier, etc.)
- **Affectations Personnel** :
  - Salari√©s affect√©s du jour
  - Heures travaill√©es par employ√©
  - Notes et observations
- **Import/Export** :
  - Import Excel structur√© (Consommations, Productions, Affectations)
  - Export multi-format (Excel, CSV, JSON)
  - Saisie op√©rateur via formulaires

### üìÖ Planning

- Affectation salari√©s ‚Üí chantiers (dates, heures/jour)
- Affectation √©quipements ‚Üí chantiers
- Gestion des disponibilit√©s

### üìÑ Documentation

- Centralisation des documents de chantier
- Upload et gestion de fichiers

---

## üèõÔ∏è Architecture technique

### Frontend

```text
React 18 + TypeScript
‚îú‚îÄ‚îÄ Vite (Build tool, HMR)
‚îú‚îÄ‚îÄ Wouter (Routing l√©ger)
‚îú‚îÄ‚îÄ TanStack Query v5 (Server state)
‚îú‚îÄ‚îÄ shadcn/ui (Composants Radix UI)
‚îú‚îÄ‚îÄ Tailwind CSS (Styling)
‚îú‚îÄ‚îÄ React Hook Form + Zod (Formulaires)
‚îú‚îÄ‚îÄ i18next (Internationalisation)
‚îî‚îÄ‚îÄ Recharts (Visualisation donn√©es)
```

### Backend

```text
Express.js (Node.js ESM)
‚îú‚îÄ‚îÄ RESTful API (GET, POST, PATCH, DELETE)
‚îú‚îÄ‚îÄ Zod validation (Runtime type checking)
‚îú‚îÄ‚îÄ Multer (File uploads - Excel imports)
‚îú‚îÄ‚îÄ Error handling middleware
‚îî‚îÄ‚îÄ Request logging
```

### Base de donn√©es

```text
PostgreSQL (Neon serverless)
‚îú‚îÄ‚îÄ Drizzle ORM (Type-safe queries)
‚îú‚îÄ‚îÄ UUID primary keys (gen_random_uuid())
‚îú‚îÄ‚îÄ Decimal precision (12,2 budgets, 10,2 rates)
‚îú‚îÄ‚îÄ Foreign keys (relations salari√©s, √©quipements, chantiers)
‚îî‚îÄ‚îÄ WebSocket support
```

### Stack complet

- **Languages** : TypeScript 5.6
- **Runtime** : Node.js (ESM modules)
- **Database** : PostgreSQL via Neon
- **ORM** : Drizzle ORM + Drizzle Kit
- **Validation** : Zod schemas
- **Styling** : Tailwind CSS + shadcn/ui
- **Icons** : Lucide React
- **Date** : date-fns
- **Excel** : xlsx

---

## üì¶ Installation & Configuration

### Pr√©requis

- Node.js 18+ ou compatible
- PostgreSQL database (Neon recommand√©)
- Git

### √âtapes d'installation

1. **Cloner le d√©p√¥t**

```bash
git clone https://github.com/dimdacin/erp-saas-construction.git
cd erp-saas-construction
```

2. **Installer les d√©pendances**

```bash
npm install
```

3. **Configurer les variables d'environnement**

Cr√©ez un fichier `.env` √† la racine :

```env
# Base de donn√©es PostgreSQL (Neon)
DATABASE_URL=postgresql://user:password@host/database?sslmode=require

# Optionnel : Variables frontend (pr√©fixe VITE_)
VITE_API_URL=http://localhost:5000
```

> ‚ö†Ô∏è **Important** : Ne jamais commiter le fichier `.env` (d√©j√† dans .gitignore)

4. **Synchroniser le sch√©ma de base de donn√©es**

```bash
npm run db:push
```

Si vous rencontrez des warnings de perte de donn√©es :

```bash
npm run db:push --force
```

5. **Lancer l'application**

```bash
# Mode d√©veloppement (port 5000)
npm run dev

# Mode production
npm run build
npm start
```

L'application sera accessible sur `http://localhost:5000`

---

## üìä Gestion des donn√©es

### Import de donn√©es Excel

Le syst√®me permet d'importer des donn√©es depuis des fichiers Excel structur√©s.

#### Script d'import automatique

Le script `server/import-data.ts` g√®re l'import intelligent :

```bash
# Ex√©cuter l'import (apr√®s avoir plac√© vos fichiers Excel)
npx tsx server/import-data.ts
```

**Fonctionnalit√©s de l'import** :

- ‚úÖ Mapping automatique des colonnes Excel ‚Üí sch√©ma DB
- ‚úÖ Matching intelligent des noms (op√©rateurs ‚Üî √©quipements)
- ‚úÖ Cr√©ation automatique des relations (FK)
- ‚úÖ Gestion des variations de casse
- ‚úÖ Bulk insert optimis√©

#### Structure Excel attendue

**Feuille RH (Salari√©s)** :
| Nom complet | Fonction | Division | Service | Centre de co√ªt | Taux horaire | ...
|-------------|----------|----------|---------|----------------|--------------|

**Feuille Meca (√âquipements)** :
| ID | Mod√®le | Immatriculation | Ann√©e | Conducteur | Type carburant | Taux horaire | ...
|----|--------|-----------------|-------|------------|----------------|--------------|

**Feuille Chantier (Projets)** :
| Code projet | Nom | B√©n√©ficiaire | Responsable | Budget MDO | Budget Mat√©riaux | ...
|-------------|-----|--------------|-------------|------------|------------------|

**Feuille Consommations (Usines)** :
| Usine ID | Date | √âlectrique (kWh) | Gaz (kWh) | Unite |
|----------|------|------------------|-----------|-------|

**Feuille Productions (Usines)** :
| Usine ID | Date | Type Marchandise | Tonnes Re√ßues | Tonnes Vendues | Client |
|----------|------|------------------|---------------|----------------|--------|

**Feuille Affectations (Personnel Usines)** :
| Usine ID | Salari√© ID | Date | Heures/Jour | Notes |
|----------|------------|------|-------------|-------|

### Modifier le sch√©ma de base de donn√©es

1. **√âditer le sch√©ma Drizzle** (`shared/schema.ts`)

```typescript
export const maNouvellTable = pgTable("ma_nouvelle_table", {
  id: varchar("id").primaryKey().default(sql`gen_random_uuid()`),
  nom: text("nom").notNull(),
  montant: decimal("montant", { precision: 12, scale: 2 }),
  createdAt: timestamp("created_at").notNull().default(sql`now()`),
});

// Ajouter les schemas Zod
export const insertMaNouvellTableSchema = createInsertSchema(maNouvellTable).omit({
  id: true,
  createdAt: true,
});

export type InsertMaNouvellTable = z.infer<typeof insertMaNouvellTableSchema>;
export type MaNouvellTable = typeof maNouvellTable.$inferSelect;
```

2. **Mettre √† jour l'interface de stockage** (`server/storage.ts`)

```typescript
interface IStorage {
  // ... m√©thodes existantes
  getMaNouvelleTable(): Promise<MaNouvellTable[]>;
  createMaNouvelleTable(data: InsertMaNouvellTable): Promise<MaNouvellTable>;
}
```

3. **Synchroniser avec la base de donn√©es**

```bash
npm run db:push
```

4. **Red√©marrer le serveur** pour recharger les mappings Drizzle

```bash
npm run dev
```

### API REST

#### Structure des endpoints

```
GET    /api/chantiers           - Liste tous les chantiers
POST   /api/chantiers           - Cr√©e un nouveau chantier
PATCH  /api/chantiers/:id       - Modifie un chantier
DELETE /api/chantiers/:id       - Supprime un chantier

GET    /api/salaries            - Liste tous les salari√©s
POST   /api/salaries            - Cr√©e un nouveau salari√©
PATCH  /api/salaries/:id        - Modifie un salari√©
DELETE /api/salaries/:id        - Supprime un salari√©

GET    /api/equipements         - Liste tous les √©quipements
POST   /api/equipements         - Cr√©e un nouvel √©quipement
PATCH  /api/equipements/:id     - Modifie un √©quipement
DELETE /api/equipements/:id     - Supprime un √©quipement

GET    /api/stock-items         - Liste articles de stock
POST   /api/stock-items         - Cr√©e un article
PATCH  /api/stock-items/:id     - Modifie un article
DELETE /api/stock-items/:id     - Supprime un article

GET    /api/depenses            - Liste des d√©penses/achats
POST   /api/depenses            - Cr√©e une d√©pense
PATCH  /api/depenses/:id/reception - Valide la r√©ception

GET    /api/usines              - Liste des usines
POST   /api/usines              - Cr√©e une usine
DELETE /api/usines/:id          - Supprime une usine

POST   /api/upload-facture      - Upload photo de facture (multipart/form-data)
```

#### Exemple d'appel API (Frontend)

```typescript
import { apiRequest, queryClient } from "@lib/queryClient";
import { useQuery, useMutation } from "@tanstack/react-query";

// Query (GET)
const { data: salaries } = useQuery<Salarie[]>({
  queryKey: ['/api/salaries'],
});

// Mutation (POST/PATCH/DELETE)
const createSalarie = useMutation({
  mutationFn: (data: InsertSalarie) => 
    apiRequest('/api/salaries', { method: 'POST', body: data }),
  onSuccess: () => {
    queryClient.invalidateQueries({ queryKey: ['/api/salaries'] });
  },
});
```

---

## üîß Extension & Personnalisation

### Ajouter un nouveau module

1. **Cr√©er le sch√©ma de donn√©es** (`shared/schema.ts`)
2. **Cr√©er les API routes** (`server/routes.ts`)
3. **Cr√©er la page frontend** (`client/src/pages/MonModule.tsx`)
4. **Ajouter la route** (`client/src/App.tsx`)
5. **Ajouter au menu** (sidebar ou navigation)
6. **Ajouter les traductions** (`client/src/i18n/locales/*.json`)

### Personnaliser le dashboard

Le dashboard actuel affiche des statistiques g√©n√©rales. Voici comment le rendre configurable :

#### Option 1 : Widgets configurables (Future)

```typescript
// Cr√©er une table de pr√©f√©rences utilisateur
export const userDashboardPrefs = pgTable("user_dashboard_prefs", {
  userId: varchar("user_id").references(() => users.id),
  widgets: text("widgets").array(), // ["budgets", "chantiers", "salaries"]
  layout: text("layout"), // JSON stringifi√©
});
```

#### Option 2 : Filtres sauvegard√©s (Future)

```typescript
// Sauvegarder les filtres pr√©f√©r√©s par utilisateur
export const savedFilters = pgTable("saved_filters", {
  id: varchar("id").primaryKey().default(sql`gen_random_uuid()`),
  userId: varchar("user_id").references(() => users.id),
  module: varchar("module", { length: 50 }), // "salaries", "equipements"
  name: text("name"), // "Mon √©quipe Construction"
  filters: text("filters"), // JSON: { division: "Mecanizare", service: "Parc" }
});
```

#### Option 3 : Colonnes personnalisables (Future)

```typescript
// Permettre √† chaque utilisateur de choisir les colonnes affich√©es
export const tablePreferences = pgTable("table_preferences", {
  userId: varchar("user_id").references(() => users.id),
  tableName: varchar("table_name", { length: 50 }),
  visibleColumns: text("visible_columns").array(),
  columnOrder: text("column_order").array(),
});
```

### Ajouter une nouvelle langue

1. **Cr√©er le fichier de traduction** :

```bash
# Cr√©er client/src/i18n/locales/es.json
{
  "dashboard": "Tablero",
  "chantiers": "Obras",
  // ... toutes les cl√©s
}
```

2. **Enregistrer la langue** (`client/src/i18n/config.ts`)

```typescript
import es from './locales/es.json';

i18n.use(initReactI18next).init({
  resources: {
    fr: { translation: fr },
    ru: { translation: ru },
    ro: { translation: ro },
    es: { translation: es }, // ‚úÖ Nouvelle langue
  },
  // ...
});
```

3. **Ajouter au s√©lecteur de langue** (composant LanguageSwitcher)

---

## üóÇÔ∏è Structure du projet

```
erp-saas-construction/
‚îú‚îÄ‚îÄ client/                    # Frontend React
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/        # Composants r√©utilisables
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ui/           # shadcn/ui components
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ProjectsTable.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pages/            # Pages de l'application
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Dashboard.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Chantiers.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Salaries.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Equipements.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Achats.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ lib/              # Utilitaires frontend
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ queryClient.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ i18n/             # Internationalisation
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ locales/
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ fr.json
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ ru.json
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ ro.json
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ App.tsx           # Routes principales
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.css         # Styles globaux
‚îÇ   ‚îî‚îÄ‚îÄ index.html
‚îÇ
‚îú‚îÄ‚îÄ server/                    # Backend Express
‚îÇ   ‚îú‚îÄ‚îÄ routes.ts             # API endpoints
‚îÇ   ‚îú‚îÄ‚îÄ storage.ts            # Interface de stockage + DbStorage
‚îÇ   ‚îú‚îÄ‚îÄ import-data.ts        # Script d'import Excel
‚îÇ   ‚îú‚îÄ‚îÄ vite.ts               # Middleware Vite
‚îÇ   ‚îî‚îÄ‚îÄ index.ts              # Point d'entr√©e serveur
‚îÇ
‚îú‚îÄ‚îÄ shared/                    # Code partag√© client/serveur
‚îÇ   ‚îî‚îÄ‚îÄ schema.ts             # Sch√©mas Drizzle + Zod
‚îÇ
‚îú‚îÄ‚îÄ attached_assets/           # Assets utilisateur (Excel, images)
‚îÇ
‚îú‚îÄ‚îÄ drizzle.config.ts         # Config Drizzle Kit
‚îú‚îÄ‚îÄ vite.config.ts            # Config Vite
‚îú‚îÄ‚îÄ tailwind.config.ts        # Config Tailwind
‚îú‚îÄ‚îÄ tsconfig.json             # Config TypeScript
‚îú‚îÄ‚îÄ package.json              # D√©pendances
‚îî‚îÄ‚îÄ README.md                 # Documentation
```

---

## üìö API Reference

### Sch√©ma de base de donn√©es

#### Table `chantiers`

```typescript
{
  id: string (UUID)
  codeProjet: string
  nom: string
  statut: string
  beneficiaire: string
  responsableId: string (FK ‚Üí salaries.id)
  budgetPrevisionnel: decimal
  budgetMainDoeuvre: decimal
  budgetMateriaux: decimal
  budgetEquipement: decimal
  budgetRealise: decimal
  budgetReelMainDoeuvre: decimal
  budgetReelMateriaux: decimal
  budgetReelEquipement: decimal
  progression: integer (0-100)
  dateDebut: date
  dateLimite: date
  description: text
  createdAt: timestamp
}
```

#### Table `salaries`

```typescript
{
  id: string (UUID)
  nom: string
  prenom: string
  poste: string
  competences: string[]
  telephone: string
  email: string
  statut: string ("disponible" | "affect√©" | "cong√©")
  tauxHoraire: decimal
  coastCenter: string        // Centre de co√ªt
  division: string           // Division/d√©partement
  services: string           // Service
  codeFonction: string       // Code fonction
  inNum: string              // Num√©ro interne
  salaryMonth: decimal       // Salaire mensuel
  acordSup: decimal          // Accord suppl√©mentaire
  createdAt: timestamp
}
```

#### Table `equipements`

```typescript
{
  id: string (UUID)
  nom: string
  type: string
  categorie: string
  marque: string
  modele: string
  numeroSerie: string
  immatriculation: string
  statut: string
  localisation: string
  dateAchat: date
  coutJournalier: decimal
  operatorId: string (FK ‚Üí salaries.id)
  operatorName: string
  year: integer
  fuelType: string
  gpsUnit: string
  meterUnit: string
  hourlyRate: decimal
  fuelConsumption: decimal
  maintenanceCost: decimal
  createdAt: timestamp
}
```

#### Table `depenses` (Achats/Stocks)

```typescript
{
  id: string (UUID)
  chantierId: string (FK ‚Üí chantiers.id, nullable)
  niveau: string ("admin" | "chantier")
  categorie: string
  description: string
  montant: decimal
  stockItemId: string (FK ‚Üí stock_items.id)
  quantite: decimal
  dateDepense: date
  statut_reception: string ("en_attente" | "receptionne")
  date_reception: date
  operateur_reception: string
  photo_facture_path: string (Base64 data URL)
  createdAt: timestamp
}
```

#### Table `stock_items`

```typescript
{
  id: string (UUID)
  itemId: string (unique)
  nom: string
  usineId: string (FK ‚Üí usines.id)
  categorie: string
  quantite: decimal
  unite: string
  createdAt: timestamp
}
```

#### Table `usine_consommations`

```typescript
{
  id: string (UUID)
  usineId: string (FK ‚Üí usines.id)
  date: date
  consommationElectrique: decimal
  consommationGaz: decimal
  unite: string (default: "kWh")
  createdAt: timestamp
}
```

#### Table `usine_productions`

```typescript
{
  id: string (UUID)
  usineId: string (FK ‚Üí usines.id)
  date: date
  typeMarchandise: string
  tonnesRecues: decimal
  tonnesVendues: decimal
  clientId: string (nullable)
  clientNom: string (nullable)
  notes: text (nullable)
  createdAt: timestamp
}
```

#### Table `usine_affectations_salaries`

```typescript
{
  id: string (UUID)
  usineId: string (FK ‚Üí usines.id)
  salarieId: string (FK ‚Üí salaries.id)
  date: date
  heuresParJour: decimal (default: 8)
  notes: text (nullable)
  createdAt: timestamp
}
```

### Relations cl√©s

```
chantiers.responsableId ‚Üí salaries.id (Responsable de projet)
equipements.operatorId ‚Üí salaries.id (Conducteur d'√©quipement)
depenses.chantierId ‚Üí chantiers.id (D√©pense li√©e √† un chantier)
stock_items.usineId ‚Üí usines.id (Article stock√© dans une usine)
usine_consommations.usineId ‚Üí usines.id (Consommation d'une usine)
usine_productions.usineId ‚Üí usines.id (Production d'une usine)
usine_affectations_salaries.usineId ‚Üí usines.id (Affectation √† une usine)
usine_affectations_salaries.salarieId ‚Üí salaries.id (Salari√© affect√©)
```
depenses.stockItemId ‚Üí stock_items.id (Article achet√©)
stock_items.usineId ‚Üí usines.id (Usine de stockage)
affectations_salaries ‚Üí chantiers + salaries (Affectation personnel)
affectations_equipements ‚Üí chantiers + equipements (Affectation mat√©riel)
```

---

## üöÄ Roadmap & Am√©liorations

### Phase 1 : Dashboard personnalisable ‚è≥

- [ ] Syst√®me de widgets drag-and-drop (react-grid-layout)
- [ ] Sauvegarder la disposition du dashboard par utilisateur
- [ ] Widgets configurables :
  - [ ] Graphiques budg√©taires personnalis√©s
  - [ ] Tableaux de bord par chantier
  - [ ] Statistiques RH (absences, heures travaill√©es)
  - [ ] Alertes √©quipement (maintenance due)
- [ ] Th√®mes de couleurs personnalisables

### Phase 2 : Exports & Rapports üìä

- [ ] Export Excel multi-feuilles (chantiers, salari√©s, √©quipements)
- [ ] G√©n√©ration PDF de rapports :
  - [ ] Rapport budg√©taire par chantier
  - [ ] Fiche de paie
  - [ ] Carnet d'√©quipement
- [ ] Export CSV configurable (choix des colonnes)
- [ ] Planification d'exports automatiques (cron jobs)

### Phase 3 : Permissions & R√¥les üîê

- [ ] Syst√®me de r√¥les : Admin, Chef de projet, RH, Comptable
- [ ] Permissions granulaires par module
- [ ] Authentification renforc√©e (Replit Auth ou JWT)
- [ ] Logs d'audit (qui a modifi√© quoi, quand)
- [ ] Approbations multi-niveaux (achats, budgets)

### Phase 4 : Fonctionnalit√©s avanc√©es ‚ú®

- [ ] Notifications en temps r√©el (WebSocket d√©j√† install√© - `ws`)
- [ ] Planning visuel avec calendrier interactif
- [ ] Gestion des cong√©s et absences
- [ ] Suivi GPS en temps r√©el des √©quipements
- [ ] Chat par chantier (communication √©quipe)
- [ ] Upload de photos de chantier (progression visuelle)
- [ ] Facturation int√©gr√©e (g√©n√©ration factures clients)

### Phase 5 : Analytics & BI üìà

- [ ] Tableaux de bord analytiques avanc√©s
- [ ] Pr√©visions budg√©taires (ML/IA)
- [ ] Analyse de rentabilit√© par chantier
- [ ] Indicateurs de performance (KPI) configurables
- [ ] Comparaison inter-chantiers
- [ ] Rapports d'√©cart budget pr√©visionnel/r√©el automatis√©s

### Phase 6 : Mobile & Offline üì±

- [ ] Application mobile (React Native ou PWA)
- [ ] Mode hors-ligne (IndexedDB sync)
- [ ] Scan de codes-barres √©quipement
- [ ] Prise de photos terrain (avec g√©olocalisation)
- [ ] Signature √©lectronique (r√©ception mat√©riel)

### Phase 7 : Int√©grations externes üîå

- [ ] Int√©gration comptabilit√© (export vers logiciels compta)
- [ ] API publique pour int√©grations tierces
- [ ] Webhooks pour √©v√©nements (nouveau chantier, budget d√©pass√©)
- [ ] Synchronisation calendrier (Google Calendar, Outlook)
- [ ] Import automatique factures (OCR)

---

## üõ†Ô∏è D√©veloppement

### Scripts disponibles

```bash
npm run dev       # Lancer le serveur de d√©veloppement (port 5000)
npm run build     # Build production (frontend + backend)
npm start         # Lancer en production
npm run check     # V√©rification TypeScript
npm run db:push   # Synchroniser le sch√©ma DB
```

### Variables d'environnement critiques

| Variable | Description | Exemple |
|----------|-------------|---------|
| `DATABASE_URL` | PostgreSQL connection string | `postgresql://user:pass@host/db` |
| `NODE_ENV` | Environnement d'ex√©cution | `development` ou `production` |
| `VITE_API_URL` | URL de l'API (frontend) | `http://localhost:5000` |

### Points d'attention techniques

#### ‚ö†Ô∏è Valeurs z√©ro dans les affichages

Le syst√®me utilise des checks stricts pour afficher les valeurs z√©ro :

```typescript
// ‚úÖ Correct
{budgetReel !== undefined && budgetReel !== null ? `${budgetReel} ‚Ç¨` : '-'}

// ‚ùå Incorrect (masque les z√©ros l√©gitimes)
{budgetReel ? `${budgetReel} ‚Ç¨` : '-'}
```

#### üîÑ Red√©marrage serveur apr√®s modification sch√©ma

Drizzle ORM charge les mappings au d√©marrage. Apr√®s `npm run db:push`, **red√©marrez le serveur** :

```bash
# Ctrl+C puis
npm run dev
```

#### üìù Mapping camelCase ‚Üî snake_case

TypeScript utilise camelCase, PostgreSQL snake_case :

```typescript
// shared/schema.ts
coastCenter: varchar("coast_center") // ‚úÖ

// API retourne
{ coastCenter: "Admin" } // ‚úÖ Drizzle mappe automatiquement
```

---

## üìÑ Licence

MIT License - Ce projet est open source.

---

## ü§ù Contribution

Les contributions sont les bienvenues ! Pour contribuer :

1. Fork le projet
2. Cr√©ez une branche feature (`git checkout -b feature/AmazingFeature`)
3. Committez vos changements (`git commit -m 'Add AmazingFeature'`)
4. Pushez vers la branche (`git push origin feature/AmazingFeature`)
5. Ouvrez une Pull Request

---

## üìû Support

Pour toute question ou assistance :

- üìß Email : <dim.dacin@gmail.com>
- üêõ Issues : [GitHub Issues](https://github.com/dimdacin/erp-saas-construction/issues)

---

## D√©velopp√© avec ‚ù§Ô∏è pour optimiser la gestion de projets de construction
